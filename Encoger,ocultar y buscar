local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local player = Players.LocalPlayer

-- Crear ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MenuUtilDelta"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Frame principal
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 320, 0, 500)
frame.Position = UDim2.new(0.5, -160, 0.5, -250)
frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 10)
corner.Parent = frame

-- T√≠tulo
local title = Instance.new("TextLabel")
title.Text = "Men√∫ √ötil - Delta"
title.Size = UDim2.new(1, 0, 0, 50)
title.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
title.TextColor3 = Color3.new(1, 1, 1)
title.Font = Enum.Font.GothamBold
title.TextSize = 22
title.Parent = frame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 10)
titleCorner.Parent = title

-- Contenedor para botones
local buttonContainer = Instance.new("Frame")
buttonContainer.Size = UDim2.new(1, -20, 1, -70)
buttonContainer.Position = UDim2.new(0, 10, 0, 60)
buttonContainer.BackgroundTransparency = 1
buttonContainer.Parent = frame

local uiList = Instance.new("UIListLayout")
uiList.Padding = UDim.new(0, 12)
uiList.HorizontalAlignment = Enum.HorizontalAlignment.Center
uiList.Parent = buttonContainer

-- Funci√≥n para crear botones estilizados
local function createButton(text, color)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0, 280, 0, 50)
	btn.BackgroundColor3 = color
	btn.Text = text
	btn.TextColor3 = Color3.new(1, 1, 1)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 18
	btn.Parent = buttonContainer
	
	local btnCorner = Instance.new("UICorner")
	btnCorner.CornerRadius = UDim.new(0, 8)
	btnCorner.Parent = btn
	
	return btn
end

-- Funci√≥n universal de teletransporte (segura)
local function teleport(cframe)
	local char = player.Character
	if char and char:FindFirstChild("HumanoidRootPart") then
		char.HumanoidRootPart.CFrame = cframe
	end
end

-- === BOT√ìN BUSCAR HIDERS ===
local searchButton = createButton("üîç Buscar Hiders", Color3.fromRGB(0, 170, 0))

-- ScrollingFrame para lista de hiders
local scrollingFrame = Instance.new("ScrollingFrame")
scrollingFrame.Size = UDim2.new(1, -20, 0, 200)
scrollingFrame.Position = UDim2.new(0, 10, 0, 300)
scrollingFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
scrollingFrame.ScrollBarThickness = 8
scrollingFrame.Visible = false
scrollingFrame.Parent = frame

local listLayout = Instance.new("UIListLayout")
listLayout.Padding = UDim.new(0, 5)
listLayout.Parent = scrollingFrame

local scrollCorner = Instance.new("UICorner")
scrollCorner.CornerRadius = UDim.new(0, 8)
scrollCorner.Parent = scrollingFrame

local function clearList()
	for _, child in ipairs(scrollingFrame:GetChildren()) do
		if child:IsA("TextButton") or child:IsA("TextLabel") then
			child:Destroy()
		end
	end
	scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
end

local function searchHiders()
	clearList()
	scrollingFrame.Visible = true
	
	local charactersFolder = Workspace:FindFirstChild("Characters")
	local hidersFolder = charactersFolder and charactersFolder:FindFirstChild("Hiders")
	if not hidersFolder then
		local label = Instance.new("TextLabel")
		label.Size = UDim2.new(1, 0, 0, 40)
		label.BackgroundTransparency = 1
		label.Text = "‚ùå Carpeta Hiders no encontrada"
		label.TextColor3 = Color3.fromRGB(255, 100, 100)
		label.Font = Enum.Font.GothamBold
		label.TextSize = 16
		label.Parent = scrollingFrame
		return
	end
	
	local found = 0
	for _, obj in ipairs(hidersFolder:GetChildren()) do
		if obj:IsA("Model") then
			local targetPlayer = Players:GetPlayerFromCharacter(obj)
			if targetPlayer and targetPlayer ~= player then
				found += 1
				local btn = Instance.new("TextButton")
				btn.Size = UDim2.new(1, -10, 0, 40)
				btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
				btn.Text = "üë§ " .. targetPlayer.Name
				btn.TextColor3 = Color3.new(1, 1, 1)
				btn.Font = Enum.Font.Gotham
				btn.TextSize = 16
				btn.Parent = scrollingFrame
				
				local c = Instance.new("UICorner")
				c.CornerRadius = UDim.new(0, 6)
				c.Parent = btn
				
				btn.MouseButton1Click:Connect(function()
					local hrp = obj:FindFirstChild("HumanoidRootPart")
					if hrp then
						teleport(hrp.CFrame * CFrame.new(0, 0, -4))
						print("üßç Teleportado detr√°s de " .. targetPlayer.Name)
					end
				end)
			end
		end
	end
	
	scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 10)
	
	if found == 0 then
		local label = Instance.new("TextLabel")
		label.Size = UDim2.new(1, 0, 0, 40)
		label.BackgroundTransparency = 1
		label.Text = "üò¥ No hay hiders actualmente"
		label.TextColor3 = Color3.fromRGB(200, 200, 200)
		label.Font = Enum.Font.Gotham
		label.TextSize = 16
		label.Parent = scrollingFrame
	end
	
	print("üîç Encontrados " .. found .. " hiders")
end

searchButton.MouseButton1Click:Connect(searchHiders)

-- === BOT√ìN SALVARSE (NUEVO/actualizado) ===
local saveButton = createButton("üè† Salvarse", Color3.fromRGB(255, 140, 0))

saveButton.MouseButton1Click:Connect(function()
	local lobbyFolder = Workspace:FindFirstChild("Lobby")
	local spawnLocation = lobbyFolder and lobbyFolder:FindFirstChild("SpawnLocation")
	if spawnLocation and spawnLocation:IsA("SpawnLocation") then
		teleport(spawnLocation.CFrame * CFrame.new(0, 3, 0))
		print("üè† Teletransportado al Lobby Spawn")
	else
		warn("‚ùå No se encontr√≥ workspace.Lobby.SpawnLocation")
	end
end)

-- === BOT√ìN AUTO RECOLECTAR COINS (TP cada 3s, verifica TouchInterest) ===
local autoFarming = false
local collectButton = createButton("üí∞ Auto Recolectar Coins", Color3.fromRGB(255, 215, 0))

collectButton.MouseButton1Click:Connect(function()
	if not autoFarming then
		autoFarming = true
		collectButton.Text = "‚èπÔ∏è Detener Auto Coins"
		collectButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
		print("üöÄ Auto recolectar coins INICIADO")
		
		task.spawn(function()
			while autoFarming do
				local mapFolder = Workspace:FindFirstChild("Map")
				local coinFolder = mapFolder and mapFolder:FindFirstChild("CoinLocations")
				if coinFolder then
					for _, coin in ipairs(coinFolder:GetChildren()) do
						if autoFarming and coin:IsA("BasePart") and coin:FindFirstChild("TouchInterest") and coin.Parent then
							local targetCFrame = coin.CFrame * CFrame.new(0, 3, 0)
							teleport(targetCFrame)
							print("üí∞ Recolectando: " .. coin.Name)
							task.wait(3)
						end
					end
				else
					warn("‚ùå Carpeta CoinLocations no encontrada")
				end
				if autoFarming then
					task.wait(1)  -- Pausa entre ciclos completos
				end
			end
		end)
	else
		autoFarming = false
		collectButton.Text = "üí∞ Auto Recolectar Coins"
		collectButton.BackgroundColor3 = Color3.fromRGB(255, 215, 0)
		print("‚èπÔ∏è Auto recolectar coins DETENIDO")
	end
end)

print("‚úÖ Men√∫ √ötil para Delta cargado. ¬°Funciona con TP seguro y verificaci√≥n de coins!")
